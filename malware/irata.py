'''
This is the script i used to decrypt the files and data used in the application

Sample Hash (sha256): 7899ea0aa36bacb8d2f94907373e550cec71d02701107cb2ef3cf629c305f877 
'''

from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
from base64 import b64decode
import requests

def decrypt(s,s1=b"&hX2aJ7$SdfW8!zQ9uB1Yx4LmN$XvG8C"):
    b64dec = b64decode(s.strip())
    firsthalf = b64dec[:16]
    secondhalf = b64dec[16:]
    cipher = AES.new(s1,AES.MODE_CBC,firsthalf)
    dec = cipher.decrypt(secondhalf)
    return unpad(dec,16).decode('utf-8')
    
with open('assets/core.txt','r') as f:
    data = f.read()

d1 = decrypt(data)

with open('assets/acc.txt','r') as f:
    data2 = f.read()

d2 = decrypt(data2)

with open('assets/ns.txt','r') as f:
    data3 = f.read()

d3 = decrypt(data3)

url = f'https://{d1}/client/v4/accounts/{d2}/storage/kv/namespaces/{d3}/values/test'

with open('assets/api.txt','r') as f:
    data4 = f.read()

auth_bearer = decrypt(data4)

headers = {'Content-Type':'application/json','Authorization':f'Bearer {auth_bearer}'}

r = requests.get(url,headers=headers)
if r.status_code == 200:
    received_data = r.text #bOJBDFmTWvWlHUvXoofNQg6DD8/P90sjaD7M+1wS/cc=
else:
    print('URL down ig')

decrypted_rec_data = decrypt(received_data)
#print(decrypted_rec_data) # www.zwavh.space

url2 = f'https://{decrypted_rec_data}/users/-1002254644684/config'

r = requests.get(url2)
print(r.status_code)
print(r.text)
'''
{"status":true,"parameters":{"encrypted":"5Q9dv6siNUyxSayCDzdC9TqRK1Cskccf7LW/lfSPEzGvPIiKplxfU/VN25RXi2w59a7E9zm6lNKkADhdaA4p5T5SZGYeYApv8Zz3mm2Nh9m2wJ5L/ufE/P4M9SBSC+jG"}}
'''

second_received_data =  {"status":True,"parameters":{"encrypted":"5Q9dv6siNUyxSayCDzdC9TqRK1Cskccf7LW/lfSPEzGvPIiKplxfU/VN25RXi2w59a7E9zm6lNKkADhdaA4p5T5SZGYeYApv8Zz3mm2Nh9m2wJ5L/ufE/P4M9SBSC+jG"}}

dec_second_data = decrypt(second_received_data['parameters']['encrypted']) 

print(dec_second_data)

'''
{'webview': 'https://irna.space/itsOK/app/', 'notification': False}
'''